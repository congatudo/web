<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<title>Time and Tank Virtual Sensors - FreeCon.ga</title>
<meta name=description content="Goal Valetudo is so great, but its home assistant integration miss out some good sensors like the time, area and tank fill percentage.
With this guide, you are going to learn how to create virtual sensor to get the cleaning time and tank percentage based on this time.
Requirements  Valetudo integrated into Home assistant  Steps   Create one input date time helper. In this example the helper will be called RobotStartCleaningTime, being an date and time helper, so the id of this helper will be: input_datetime.">
<meta name=author content="Conga hacking community"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"FreeCon.ga","url":"https:\/\/freeconga.github.io\/web\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/freeconga.github.io\/web\/"}</script>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/freeconga.github.io\/web\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/freeconga.github.io\/web\/blog\/time-and-tank-virtual-sensors\/","name":"Time and tank virtual sensors"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"txitxo0"},"headline":"Time and Tank Virtual Sensors","description":"Goal Valetudo is so great, but its home assistant integration miss out some good sensors like the time, area and tank fill percentage.\nWith this guide, you are going to learn how to create virtual sensor to get the cleaning time and tank percentage based on this time.\nRequirements  Valetudo integrated into Home assistant  Steps   Create one input date time helper. In this example the helper will be called RobotStartCleaningTime, being an date and time helper, so the id of this helper will be: input_datetime.","inLanguage":"en","wordCount":224,"datePublished":"2021-11-06T18:57:12","dateModified":"2021-11-06T18:57:12","image":"https:\/\/freeconga.github.io\/web\/freeconga.png","keywords":["home assistant, valetudo, sensor"],"mainEntityOfPage":"https:\/\/freeconga.github.io\/web\/blog\/time-and-tank-virtual-sensors\/","publisher":{"@type":"Organization","name":"https:\/\/freeconga.github.io\/web\/","logo":{"@type":"ImageObject","url":"https:\/\/freeconga.github.io\/web\/freeconga.png","height":60,"width":60}}}</script>
<meta property="og:title" content="Time and Tank Virtual Sensors">
<meta property="og:description" content="Goal Valetudo is so great, but its home assistant integration miss out some good sensors like the time, area and tank fill percentage.
With this guide, you are going to learn how to create virtual sensor to get the cleaning time and tank percentage based on this time.
Requirements  Valetudo integrated into Home assistant  Steps   Create one input date time helper. In this example the helper will be called RobotStartCleaningTime, being an date and time helper, so the id of this helper will be: input_datetime.">
<meta property="og:image" content="https://freeconga.github.io/web/freeconga.png">
<meta property="og:url" content="https://freeconga.github.io/web/blog/time-and-tank-virtual-sensors/">
<meta property="og:type" content="website">
<meta property="og:site_name" content="FreeCon.ga">
<meta name=twitter:title content="Time and Tank Virtual Sensors">
<meta name=twitter:description content="Goal Valetudo is so great, but its home assistant integration miss out some good sensors like the time, area and tank fill percentage.
With this guide, you are going to learn how to create virtual â€¦">
<meta name=twitter:image content="https://freeconga.github.io/web/freeconga.png">
<meta name=twitter:card content="summary">
<link href=https://freeconga.github.io/web/img/favicon.ico rel=icon type=image/x-icon>
<meta name=generator content="Hugo 0.89.1">
<link rel=alternate href=https://freeconga.github.io/web/index.xml type=application/rss+xml title=FreeCon.ga><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous>
<link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous>
<link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://freeconga.github.io/web/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://freeconga.github.io/web/css/syntax.css><link rel=stylesheet href=https://freeconga.github.io/web/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top navbar-custom">
<div class=container-fluid>
<div class=navbar-header>
<button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://freeconga.github.io/web/>FreeCon.ga</a>
</div>
<div class="collapse navbar-collapse" id=main-navbar>
<ul class="nav navbar-nav navbar-right">
<li>
<a title=Home href=https://freeconga.github.io/web/>Home</a>
</li>
<li>
<a title=Congas href=https://freeconga.github.io/web/page/congas/>Congas</a>
</li>
<li>
<a title=About href=https://freeconga.github.io/web/page/about/>About</a>
</li>
<li>
<a title=Blog href=https://freeconga.github.io/web/blog/index.html>Blog</a>
</li>
</ul>
</div>
<div class=avatar-container>
<div class=avatar-img-border>
<a title=FreeCon.ga href=https://freeconga.github.io/web/>
<img class=avatar-img src=https://freeconga.github.io/web/freeconga.png alt=FreeCon.ga>
</a>
</div>
</div>
</div>
</nav>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div>
<header class=header-section>
<div class="intro-header no-img">
<div class=container>
<div class=row>
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<div class=blog-heading>
<h1>Time and Tank Virtual Sensors</h1>
<hr class=small>
</div>
</div>
</div>
</div>
</div>
</header>
<div class=b-hero>
<img class=b-hero__image src>
<div class=b-hero__info>
<h1 class=b-hero__title>Time and Tank Virtual Sensors</h1>
<div class=b-hero__author-date>
<span>Written by: txitxo0</span>
<span>November 6, 2021</span>
</div>
</div>
</div>
<h2 id=goal>Goal</h2>
<p>Valetudo is so great, but its home assistant integration miss out some good sensors like the time, area and tank fill percentage.</p>
<p>With this guide, you are going to learn how to create virtual sensor to get the cleaning time and tank percentage based on this time.</p>
<h2 id=requirements>Requirements</h2>
<ul>
<li>Valetudo integrated into Home assistant</li>
</ul>
<h2 id=steps>Steps</h2>
<ol>
<li>
<p>Create one input date time helper. In this example the helper will be called RobotStartCleaningTime, being an date and time helper, so the id of this helper will be: <code>input_datetime.robotstartcleaningtime</code></p>
</li>
<li>
<p>In the configuration file, we are going to create three sensors</p>
<ol>
<li>
<p>All history cleaning time</p>
<pre><code>  - platform: history_stats
    name: Conga Cleaning
    entity_id: vacuum.conga
    state: 'cleaning'
    type: time
    start: &quot;{{ state_attr('input_datetime.robotstartcleaningtime', 'timestamp') }}&quot;
    end: '{{ now() }}'
</code></pre>
<p>With the entity_id for you vacuum robot and the helper you created before</p>
</li>
<li>
<p>Tank virtual sensor, based on the cleaning time stats and conga cleaning in time</p>
<pre><code>  - platform: template
    sensors:
      conga_cleaning_time:
        friendly_name: &quot;Conga Cleaning Time&quot;
        value_template: &quot;{{ state_attr('sensor.conga_cleaning', 'value') }}&quot;
      conga_tank_percentage:
        friendly_name: &quot;Conga Tank Percentage&quot;
        value_template: &quot;{{ ( states('sensor.conga_cleaning')|float * (100)|float / (10)|float ) | round(0)  }}&quot;
</code></pre>
<p>This conga_tank_percentage is valid for my tank based on rule how many minutes cleaning the tank needs to be full . Do the maths for your needs</p>
</li>
<li>
<p>Now, you are able to use this sensor in some card or even better, to trigger some automation</p>
</li>
</ol>
</li>
</ol>
<footer>
<div class=container>
<div class=row>
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<ul class="list-inline text-center footer-links">
<li>
<a href=https://github.com/freeconga title=GitHub>
<span class="fa-stack fa-lg">
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i>
</span>
</a>
</li>
<li>
<a href=https://telegram.me/freeconga title=Telegram>
<span class="fa-stack fa-lg">
<i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-telegram fa-stack-1x fa-inverse"></i>
</span>
</a>
</li>
</ul>
<p class="credits copyright text-muted">
Conga hacking community
&nbsp;&bull;&nbsp;&copy;
2021
&nbsp;&bull;&nbsp;
<a href=https://freeconga.github.io/web/>FreeCon.ga</a>
</p>
<p class="credits theme-by text-muted">
<a href=https://gohugo.io>Hugo v0.89.1</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a>
</p>
</div>
</div>
</div>
</footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script>
<script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://freeconga.github.io/web/js/main.js></script><script>renderMathInElement(document.body)</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://freeconga.github.io/web/js/load-photoswipe.js></script>
</body>
</html>